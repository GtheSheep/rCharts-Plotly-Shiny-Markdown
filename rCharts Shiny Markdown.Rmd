---
title: "rCharts and Plotly Shiny Markdown"
author: "gjames"
date: "3 January 2016"
output: ioslides_presentation
runtime: shiny
---

## Shiny Presentation

This R markdown is adapted from the Shiny slides example, but to incorporate rCharts and Plotly as the plotting packages. I have once again used a loan tape from the Lending Club.

```{r, echo=FALSE,results='asis',comment=NA,warning=FALSE,message=FALSE}
library(data.table)
data <- data.table::fread("LoanStats3c.csv", header = TRUE, sep = ",")
library(plyr)
library(dplyr)
termGradeVals <- dplyr::group_by(data, c("term", "grade")) %>% plyr::ddply(c("term", "grade"), summarize, balance=sum(as.numeric(loan_amnt)))
library(rCharts)
tgPlot <- hPlot(balance ~ grade, group = "term", data = termGradeVals, type = "column")
tgPlot$plotOptions(series = list(stacking = "normal"))
tgPlot$legend(title = list(text = "Term"))
library(knitr)
opts_chunk$set(comment = NA, results = "asis", comment = NA, tidy = F)
tgPlot$show('iframesrc', cdn = TRUE)
```

## Slide with Interactive Plot

```{r, echo=FALSE,comment=NA,warning=FALSE,message=FALSE}
library(mvtnorm)
inputPanel(
  selectInput("obs", label = "Number of Observations:",
              choices = c(50, 100, 150, 200), selected = 50),
  
  sliderInput("corr", label = "Correlation of Copula:",
              min = 0.05, max = 0.95, value = 0.75, step = 0.05)
)

observations <- reactive({
  corr <- matrix(c(1, input$corr, input$corr,input$corr, 1, input$corr,input$corr, input$corr, 1), ncol = 3)
  obs <- mvtnorm::rmvnorm(as.numeric(input$obs), sigma = corr)
  obs <- setNames(data.frame(obs), c("x", "y", "z"))
  return(obs)
  })

library(plotly)
renderPlotly({plot_ly(observations(), x = x, y = y, z = z, type = "scatter3d", mode = "markers", color = x)})
```

## Information Slide

- Data Source: https://resources.lendingclub.com/LoanStats3c.csv.zip

## Slide with R Code and Output

```{r}
dplyr::top_n(dplyr::as.tbl(data), 10, loan_amnt) %>% dplyr::select(member_id, loan_amnt)
```


